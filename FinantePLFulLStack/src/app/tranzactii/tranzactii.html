<div class="container">
	
	
	
	<div class="top-header-box">
  <div class="left-section">
    <h2>ğŸ“Š TranzacÈ›ii ING (din API)</h2>
    <mat-slide-toggle [(ngModel)]="hoverMode">ActiveazÄƒ Hover</mat-slide-toggle>
  </div>
	
	  <div class="center-section">
    <span class="label">ğŸ’° Profit total:</span>
    <span class="value profit">{{ getTotalProfit() | number:'1.2-2' }} lei</span>
  </div>
  
  <div class="right-section">
    <span class="label">ğŸ§® Total curent:</span>
    <span class="value">{{ getBannerTotal() | number:'1.2-2' }} lei</span>
  </div>
</div>



	
	<!-- ğŸ”¹ GRUP BUTOANE â€“ IMPORT / OPERAÈšIUNI -->
<div class="actions-wrapper">
  <!-- ğŸŸ¦ BOX STÃ‚NGA â€“ Import & surse -->
  <div class="box-shadow import-box">
    <h4>ğŸ“¥ Import & surse</h4>
	<div class="import-filtrare-grid">
	  <!-- ğŸŸ¢ Coloana 1 â€“ Import & surse -->
    <div class="col-import">
	<!-- ğŸ”¹ Grup 1: sursÄƒ + import -->
  <div class="import-actions-group">
    <mat-radio-group [(ngModel)]="sursaSelectata" class="radio-group">
      <mat-radio-button value="ING">ING </mat-radio-button>
      <mat-radio-button value="PLUXEE">Pluxee</mat-radio-button>
    </mat-radio-group>

    <button mat-raised-button color="primary" (click)="importCsv()">
      <mat-icon>upload_file</mat-icon>
      ImportÄƒ extrass
    </button>

    <mat-checkbox [(ngModel)]="autoSplitEnabled">AutoSplit automat</mat-checkbox>
  </div>

  <!-- ğŸ”¹ Grup 2: analitice -->
  <div class="import-analytics-group">
    <button mat-raised-button color="accent" (click)="showPie = !showPie">
      {{ showPie ? 'âŒ Ãnchide Chart' : 'ğŸ“Š Vezi distribuÈ›ia pe categorii' }}
    </button>
  </div>
	</div>
	 <!-- ğŸŸ£ Coloana 2 â€“ Filtrare -->
    <div class="col-filtru">
      <h5>ğŸ” Filtrare tranzacÈ›ii</h5>

      <mat-radio-group [(ngModel)]="filtruSursaVizual" class="filter-group">
        <mat-radio-button value="TOATE">Toate</mat-radio-button>
        <mat-radio-button value="ING">ING</mat-radio-button>
        <mat-radio-button value="PLUXEE">Pluxee</mat-radio-button>
        <mat-radio-button value="CASH">Cash</mat-radio-button>
      </mat-radio-group>

      <p class="hint-filtru">
        Alege sursa pentru a filtra doar tranzacÈ›iile corespunzÄƒtoare Ã®n tabel.
      </p>
    </div>
	</div>

   
  </div>
	
  <!-- ğŸŸ© BOX DREAPTA â€“ OperaÈ›iuni -->
  <div class="box-shadow operations-box">
    <h4>âš™ï¸ OperaÈ›iuni tranzacÈ›ii</h4>


	<div class="operations-content">
	<!-- ğŸ”¹ STÃ‚NGA: OperaÈ›iuni tranzacÈ›ii -->
	<div class="operations-inner">
    <mat-form-field appearance="outline">
      <mat-label>SelecteazÄƒ categorie</mat-label>
      <mat-select [(ngModel)]="bulkCategorie">
        <mat-option *ngFor="let cat of categorii" [value]="cat">{{ cat }}</mat-option>
      </mat-select>
    </mat-form-field>

    <button mat-raised-button color="primary" (click)="applyBulkUpdate()">
      âœ… AplicÄƒ pe liniile selectate
    </button>

    <button mat-raised-button color="accent" (click)="adaugaTranzactieNoua()">
      â• AdaugÄƒ tranzacÈ›ie nouÄƒ
    </button>
	
	<!-- ğŸ”¹ SUMAR CONSUM -->
<div class="consum-summary">
  <div class="consum-item">
    <mat-icon class="beer-icon">sports_bar</mat-icon>
    <div class="consum-text">
      <span class="label">Beri:</span>
      <span class="value">{{ totalBeri }} x</span>
      <span class="price">{{ totalPretBeri | number:'1.2-2' }} lei</span>
    </div>
  </div>

  <div class="consum-item">
    <mat-icon class="cigarette-icon">smoking_rooms</mat-icon>
    <div class="consum-text">
      <span class="label">ÈšigÄƒri:</span>
      <span class="value">{{ totalTigari }} pachete</span>
      <span class="price">{{ totalPretTigari | number:'1.2-2' }} lei</span>
    </div>
  </div>
</div>

	

    <button *ngIf="hasSelection()" mat-raised-button color="warn" (click)="bulkDelete()">
      ğŸ—‘ï¸ È˜terge selectate
    </button>
  </div>
  <!-- ğŸ”¹ Carduri totaluri ING / PLUXEE -->
  <div class="cards-col">
  <div class="cards-totale">
    <div class="total-card" 
         *ngFor="let t of totaleSurse"
         [ngClass]="t.sursa.toLowerCase()">

      <div class="card-header-with-balance">
        <div class="left">
          <!-- logo dinamic -->
          <img [src]="'assets/img/' + t.sursa.toLowerCase() + '.png'" 
               [alt]="t.sursa" 
               class="icon-sursa" />
          <h4>{{ t.sursa }}</h4>
        </div>

        <div class="right">
          <span class="label">âš–ï¸ BalanÈ›Äƒ totalÄƒ:</span>
          <span class="value">
            {{ getBalanta(t.sursa.toUpperCase()) | number:'1.2-2' }} lei
          </span>
        </div>
      </div>

      <div class="linie cheltuieli">
        <span>ğŸ’³ Cheltuieli:</span>
        <strong>{{ getTotalCheltuieli(t.sursa.toUpperCase()) | number:'1.2-2' }} lei</strong>
      </div>

      <div class="linie venituri">
        <span>ğŸ’° Venituri:</span>
        <strong>{{ getTotalVenituri(t.sursa.toUpperCase()) | number:'1.2-2' }} lei</strong>
      </div>
    </div>
  </div>
</div>

	</div>
  </div>



	
	
</div>

	<!-- âœ… Buton & Chart Pie -->

	<div class="chart-container" *ngIf="showPie">
		<div class="chart-actions">
			<button mat-raised-button color="primary" (click)="chartMode = 'pie'">ğŸ¥§ Placinta</button>
			<button mat-raised-button color="accent" (click)="chartMode = 'bar'">ğŸ“Š Bara</button>
			<button mat-raised-button color="warn" (click)="showPie = false">âŒ Ãnchide Chart</button>
		</div>

		<div class="pie-wrapper">
		  <canvas
			baseChart
			[data]="pieChartData"
			[options]="pieChartOptions"
			[type]="chartMode"
			[height]="550"      
			[width] ="900">
		  </canvas>
</div>
	</div>

	<!-- ğŸ”¥ OVERLAY DE ÃNCÄ‚RCARE -->
	<div class="ocr-loader" *ngIf="isLoadingOcr">
  <div class="loader-box">
    <div class="spinner"></div>  <!-- ğŸ”¹ Ã®nchis corect -->
    <p>Se proceseazÄƒ bonul OCR...</p>

    <div class="progress-container">
      <div class="progress-bar" [style.width.%]="uploadProgress"></div>
    </div>

    <p class="progress-text">{{ uploadProgress }}%</p>
  </div>
</div>
<div class="table-container">

	<!-- ================= TABLE ================= -->
	<table mat-table [dataSource]="getTranzactiiFiltrate()"
       class="mat-elevation-z8 full-width"
       [ngClass]="{'hover-enabled': hoverMode}"
       (mouseleave)="resetTotal()">
	   
	 <!-- ğŸ”¹ HEADERUL COMPLET â€“ cu icoane + etichete -->
  <tr mat-header-row *matHeaderRowDef="displayedColumns" class="custom-header">
    <th mat-header-cell *matHeaderCellDef="let column" class="header-cell select">â˜‘ï¸</th>
    <th mat-header-cell *matHeaderCellDef="let column" class="header-cell id">ğŸ†” ID</th>
    <th mat-header-cell *matHeaderCellDef class="header-cell">ğŸ“… Data</th>
    <th mat-header-cell *matHeaderCellDef class="header-cell">ğŸ” Tip tranzacÈ›ie</th>
    <th mat-header-cell *matHeaderCellDef class="header-cell">ğŸ’° SumÄƒ</th>
    <th mat-header-cell *matHeaderCellDef class="header-cell">ğŸ’³ Tip platÄƒ</th>
    <th mat-header-cell *matHeaderCellDef class="header-cell">ğŸ†” Sursa</th>
    <th mat-header-cell *matHeaderCellDef class="header-cell">ğŸ“Š Sold final</th>
    <th mat-header-cell *matHeaderCellDef class="header-cell">ğŸ’³ Nr. card</th>
    <th mat-header-cell *matHeaderCellDef class="header-cell">ğŸ§¾ Merchant</th>
    <th mat-header-cell *matHeaderCellDef class="header-cell">ğŸ·ï¸ Categorie</th>
    <th mat-header-cell *matHeaderCellDef class="header-cell">ğŸº # Beri</th>
    <th mat-header-cell *matHeaderCellDef class="header-cell">ğŸš¬ # ÈšigÄƒri</th>
    <th mat-header-cell *matHeaderCellDef class="header-cell">âš™ï¸ AcÈ›iuni</th>
  </tr>

  <!-- ID -->
  <ng-container matColumnDef="id">
    <th mat-header-cell *matHeaderCellDef>ID</th>
    <td mat-cell *matCellDef="let element">{{ element.id }}</td>
  </ng-container>

  <!-- ğŸ”¹ SURSA -->
<ng-container matColumnDef="sursaCard">
  <th mat-header-cell *matHeaderCellDef>Sursa</th>

  <td mat-cell *matCellDef="let element"
    (dblclick)="startEdit(element, 'sursaCard')"
    class="editable-cell"
    [class.just-updated]="element.justUpdated">


    <!-- ğŸ”¸ Mod vizualizare -->
    <ng-container *ngIf="!(editingCell?.id === element.id && editingCell?.field === 'sursaCard'); else editSursa">
      <span class="badge badge-sursa" [ngClass]="element.sursaCard?.toLowerCase()">
        {{ element.sursaCard || '-' }}
      </span>
    </ng-container>

    <!-- ğŸ”¸ Mod editare -->
    <ng-template #editSursa>
      <mat-form-field appearance="outline" style="width: 110px; margin: 0;">
        <mat-select [(ngModel)]="editValue"
                    (selectionChange)="saveEdit(element, 'sursaCard')"
                    (closed)="cancelEdit()"
                    panelClass="sursa-dropdown">
          <mat-option value="ING">
            <span class="badge-sursa ing">ING</span>
          </mat-option>
          <mat-option value="PLUXEE">
            <span class="badge-sursa pluxee">PLUXEE</span>
          </mat-option>
          <mat-option value="CASH">
            <span class="badge-sursa cash">CASH</span>
          </mat-option>
        </mat-select>
      </mat-form-field>
    </ng-template>

  </td>
</ng-container>



<!-- Data Tranzactie -->
<ng-container matColumnDef="dataTranzactie">
	<th mat-header-cell *matHeaderCellDef> Data tranzacÈ›ie</th>
<td mat-cell *matCellDef="let element">
	<ng-container *ngIf="!element.editing; else editDate">
      {{ element.dataTranzactie | date:'dd/MM/yyyy' }}
	</ng-container>
	<ng-template #editDate>
	<input matInput type="date" [(ngModel)]="element.dataTranzactie"/>
</ng-template>
</td>
</ng-container>

<!-- Tip Tranzactie -->
<ng-container matColumnDef="tipTranzactie">
	<th mat-header-cell *matHeaderCellDef> Tip tranzacÈ›ie</th>
<td mat-cell *matCellDef="let element">

	<!-- ğŸ”¸ Mod vizualizare -->
	<ng-container *ngIf="!element.editing; else editTip">
      {{ element.tipTranzactie }}
	</ng-container>

	<!-- ğŸ”¸ Mod editare -->
	<ng-template #editTip>
	<mat-form-field appearance="outline" style="width: 180px">
		<mat-label>Tip tranzacÈ›ie</mat-label>
		<mat-select [(ngModel)]="element.tipTranzactie">
			<mat-option *ngFor="let tip of tipuriTranzactie" [value]="tip">
            {{ tip }}
			</mat-option>
		</mat-select>
	</mat-form-field>
</ng-template>

</td>
</ng-container>

<ng-container matColumnDef="locked">
	<th mat-header-cell *matHeaderCellDef> ğŸ”’</th>
<td mat-cell *matCellDef="let row">
	<span *ngIf="row.esteProcesata" title="TranzacÈ›ie blocatÄƒ">
      ğŸ”’
	</span>
</td>

</ng-container>
	
<ng-container matColumnDef="actions">
	<th mat-header-cell *matHeaderCellDef> âš™ï¸</th>
<td mat-cell *matCellDef="let element">
	  
	<ng-container *ngIf="element.editing && element.id === 0">
		<button mat-icon-button color="primary" (click)="confirmTranzactieNoua(element)">âœ…</button>
		<button mat-icon-button color="warn" (click)="anuleazaTranzactieNoua(element)">âŒ</button>
	</ng-container>
	  
	<!-- DacÄƒ nu e linie splitatÄƒ -->
	<ng-container *ngIf="!element.isSplitChild">
		<button mat-icon-button color="accent" (click)="addSplitRow(element)">â•</button>
		<button mat-icon-button color="warn" (click)="removeSplitRow(element)">âŒ</button>
		<button mat-icon-button color="primary" (click)="confirmSplit(element)">âœ…</button>
		<button mat-icon-button color="accent" (click)="openFileDialog(element)">
  ğŸ“
		</button>
		<input type="file" #fileInput style="display:none" (change)="onFileSelected($event, element.id)" accept="image/*">
		</ng-container>

		<!-- DacÄƒ e linie splitatÄƒ -->
		<ng-container *ngIf="element.isSplitChild">
			<mat-form-field appearance="outline" class="split-suma">
				<mat-label>SumÄƒ</mat-label>
				<input matInput type="number" [(ngModel)]="element.suma" (ngModelChange)="actualizeazaSoldFinal(element)"
				       class="sum-input"/>
			</mat-form-field>

			<mat-form-field appearance="outline" class="split-categorie">
				<mat-label>Categorie</mat-label>
				<input
 type="text"
				       matInput
				       [(ngModel)]="element.categorie"
				       [matAutocomplete]="auto"
/>
				<mat-autocomplete #auto="matAutocomplete">
					<mat-option *ngFor="let cat of categorii" [value]="cat">
                {{ cat }}
					</mat-option>
				</mat-autocomplete>
			</mat-form-field>

			<button mat-icon-button color="warn" (click)="removeSplitRow(element)">âŒ</button>
		</ng-container>
		
	</td>
</ng-container>


<!-- =========================
     CATEGORIE (COMBINATÄ‚)
========================= -->
<ng-container matColumnDef="categorie">
	<th mat-header-cell *matHeaderCellDef> ğŸ·ï¸ Categorie</th>
<td mat-cell *matCellDef="let element">

	<!-- ğŸ”¹ Mod vizualizare (needitabil) -->
	<ng-container *ngIf="!element.editing; else editMode">

		<span
 [ngClass]="{
          'tigari-label badge-tigari': element.categorie?.toLowerCase().includes('tigari') 
                                       && !element.categorie?.toLowerCase().includes('bere'),
          'bere-label badge-bere': element.categorie?.toLowerCase().includes('bere') 
                                   && !element.categorie?.toLowerCase().includes('tigari'),
          'mixed-label': element.categorie?.toLowerCase().includes('tigari') 
                         && element.categorie?.toLowerCase().includes('bere')
        }">
        {{ element.categorie }}
		</span>

		<!-- ğŸ” AutoSplit vizual -->
		<span *ngIf="element.detalii?.includes('ğŸ”')"
		      matTooltip="AutoSplit generat automat din parser"
		      style="margin-left: 6px; color: #2196f3; font-size: 16px;">
        ğŸ”
		</span>

		<!-- âœï¸ Buton editare -->
		<button mat-icon-button color="primary" (click)="editCategorie(element)">
        âœï¸
		</button>
	</ng-container>

	<!-- ğŸ”¹ Mod editare -->
	<ng-template #editMode>
	<mat-form-field appearance="outline" class="edit-dropdown">
		<mat-label>Categorie</mat-label>
		<mat-select [(ngModel)]="element.categorie">
			<mat-option *ngFor="let cat of categorii" [value]="cat">
            {{ cat }}
			</mat-option>
		</mat-select>
	</mat-form-field>

	<mat-checkbox [(ngModel)]="element.selected" title="SelecteazÄƒ pentru bulk"/>

	<button mat-icon-button color="primary" (click)="save(element)">âœ…</button>
	<button mat-icon-button color="warn" (click)="cancel(element)">âŒ</button>
</ng-template>

</td>
</ng-container>

<!-- ğŸº Nr. Beri -->
<ng-container matColumnDef="nrBeri">
  <th mat-header-cell *matHeaderCellDef>ğŸº # Beri</th>
  <td mat-cell *matCellDef="let element">
    <ng-container *ngIf="element.categorie?.toUpperCase() === 'BERE'">
      <mat-form-field appearance="outline" style="width: 80px; position: relative;">
        <span class="icon-prefix bere-icon">ğŸº</span>
        <input
          matInput
          type="number"
          min="0"
          [(ngModel)]="element.nrBeri"
          (ngModelChange)="salveazaBeri(element)"
        />
      </mat-form-field>
    </ng-container>
  </td>
</ng-container>

<!-- ğŸš¬ Nr. ÈšigÄƒri -->
<ng-container matColumnDef="nrTigari">
  <th mat-header-cell *matHeaderCellDef>ğŸš¬ # ÈšigÄƒri</th>
  <td mat-cell *matCellDef="let element">
    <ng-container *ngIf="element.categorie?.toUpperCase() === 'TIGARI'">
      <mat-form-field appearance="outline" style="width: 80px; position: relative;">
        <span class="icon-prefix tigari-icon">ğŸš¬</span>
        <input
          matInput
          type="number"
          min="0"
          [(ngModel)]="element.nrTigari"
          (ngModelChange)="salveazaTigari(element)"
        />
      </mat-form-field>
    </ng-container>
  </td>
</ng-container>



<!-- ğŸ”¹ Suma -->
<ng-container matColumnDef="suma">
	<th mat-header-cell *matHeaderCellDef
	    (click)="toggleColumnSum()"
	    [class.sum-active]="sumEntireColumn"
	    title="Click pentru total pe coloanÄƒ / revenire la hover">
    Suma (lei)
	</th>

	<td mat-cell *matCellDef="let element; let i = index"
	    (mouseenter)="onHover(i, element.suma, element.tipTranzactie)"
	    (dblclick)="startEdit(element, 'suma')"
	    class="hover-cell editable-cell">

		<!-- ğŸ”¸ Vizualizare normalÄƒ -->
		<ng-container *ngIf="!(editingCell?.id === element.id && editingCell?.field === 'suma'); else editMode">
			<strong>{{ element.suma | number:'1.2-2' }}</strong>
		</ng-container>

		<!-- ğŸ”¸ Mod editare -->
		<ng-template #editMode>
		<input type="number"
		       [(ngModel)]="editValue"
		       (keydown.enter)="saveEdit(element, 'suma')"
		       (keydown.escape)="cancelEdit()"
		       (blur)="saveEdit(element, 'suma')"
		       class="inline-input"
		       autofocus>
	</ng-template>

</td>
</ng-container>



<!-- Select -->
<ng-container matColumnDef="select">
	<th mat-header-cell *matHeaderCellDef> âœ”</th>
<td mat-cell *matCellDef="let element">
	<mat-checkbox [(ngModel)]="element.selected"/>
</td>
</ng-container>

<!-- EsteCredit -->
<ng-container matColumnDef="esteCredit">
	<th mat-header-cell *matHeaderCellDef> Tip platÄƒ</th>
<td mat-cell *matCellDef="let element">
	<!-- ğŸ”¸ Vizualizare normalÄƒ -->
	<ng-container *ngIf="!element.editing; else editTipPlata">
		<span [ngClass]="element.esteCredit ? 'credit' : 'debit'">
        {{ element.esteCredit ? 'Credit' : 'Debit' }}
		</span>
	</ng-container>

	<!-- ğŸ”¸ Mod editare -->
	<ng-template #editTipPlata>
	<mat-form-field appearance="outline" style="width: 120px;">
		<mat-label>Tip platÄƒ</mat-label>
		<mat-select [(ngModel)]="element.esteCredit" (selectionChange)="actualizeazaSoldFinal(element)">
			<mat-option [value]="true">Credit</mat-option>
			<mat-option [value]="false">Debit</mat-option>
		</mat-select>

	</mat-form-field>
</ng-template>
</td>
</ng-container>


<!-- SoldFinal -->
<ng-container matColumnDef="soldFinal">
	<th mat-header-cell *matHeaderCellDef> Sold final</th>
<td mat-cell *matCellDef="let element">{{ element.soldFinal | number:'1.2-2' }}</td>
</ng-container>

<!-- Data Decontarii -->
<ng-container matColumnDef="dataDecontarii">
	<th mat-header-cell *matHeaderCellDef> Data decontÄƒrii</th>
<td mat-cell *matCellDef="let element">
        {{ element.dataDecontarii | date:'dd/MM/yyyy' }}
</td>
</ng-container>

<!-- NumarCard -->
<ng-container matColumnDef="numarCard">
	<th mat-header-cell *matHeaderCellDef> Nr. card</th>
<td mat-cell *matCellDef="let element">{{ element.numarCard }}</td>
</ng-container>
	
<!-- Merchant-->

<ng-container matColumnDef="merchant">
	<th mat-header-cell *matHeaderCellDef> Merchant</th>
<td mat-cell *matCellDef="let element">

	<!-- ğŸ”„ DacÄƒ e Ã®n mod editare, aratÄƒ inputul -->
	<ng-container *ngIf="element.editing; else merchantDisplay">
		<input matInput [(ngModel)]="element.merchant" placeholder="Merchant"/>
	</ng-container>

	<!-- ğŸ§¾ AfiÈ™are normalÄƒ cu pictograme OCR dacÄƒ nu e Ã®n editare -->
	<ng-template #merchantDisplay>
	<ng-container *ngIf="esteMagazinOCR(element.merchant); else normalMerchant">
        
		<!-- PÄƒrinte OCR -->
		<span *ngIf="!element.isSplitChild"
		      class="ocr-icon"
		      matTooltip="AtaÈ™eazÄƒ bon OCR pentru {{ element.merchant }}"
		      (click)="openFileDialog(element)">ğŸ§¾</span>

		<!-- Copil OCR -->
		<span *ngIf="element.isSplitChild"
		      class="ocr-icon child"
		      matTooltip="{{ formatDetaliiTooltip(element) }}">ğŸ“„</span>

		<strong>{{ element.merchant }}</strong>
	</ng-container>

	<!-- Caz general fÄƒrÄƒ OCR -->
	<ng-template #normalMerchant>
	             {{ element.merchant }}
</ng-template>
</ng-template>
</td>
</ng-container>



<!-- Data Autorizarii -->
<ng-container matColumnDef="dataAutorizarii">
	<th mat-header-cell *matHeaderCellDef> Data autorizÄƒrii</th>
<td mat-cell *matCellDef="let element">
        {{ element.dataAutorizarii | date:'dd/MM/yyyy' }}
</td>
</ng-container>

<!-- Numar Autorizare -->
<ng-container matColumnDef="numarAutorizare">
	<th mat-header-cell *matHeaderCellDef> Nr. autorizare</th>
<td mat-cell *matCellDef="let element">{{ element.numarAutorizare }}</td>
</ng-container>

<!-- Referinta -->
<ng-container matColumnDef="referinta">
	<th mat-header-cell *matHeaderCellDef> ReferinÈ›Äƒ</th>
<td mat-cell *matCellDef="let element">{{ element.referinta }}</td>
</ng-container>


<!-- Detalii -->
<ng-container matColumnDef="detalii">
	<th mat-header-cell *matHeaderCellDef> Detalii</th>
<td mat-cell *matCellDef="let element">
	<div class="detalii-cell">
		<span>{{ element.detalii }}</span>

		<span
 class="status-badge"
		      [ngClass]="element.esteProcesata ? 'procesata' : 'activa'">
      {{ element.esteProcesata ? 'ProcesatÄƒ âœ…' : 'ActivÄƒ ğŸŸ¢' }}
		</span>
	</div>
</td>

</ng-container>

<!-- ğŸ”¹ RÃ¢ndurile tabelului -->
<tr mat-row
  *matRowDef="let row; columns: displayedColumns;"
  [ngClass]="{
    'magazin-ocr': esteMagazinOCR(row.merchant),
    'new-child': row.isNewChild,
    'ocr-child': row.isSplitChild,
    'split-row': row.isSplitChild,
    'delete-highlight': row.highlightDelete,
    'credit-row': row.esteCredit && !row.isSplitChild && !row.isNewChild,
    'debit-row': !row.esteCredit && !row.isSplitChild && !row.isNewChild,
    'locked-row': row.esteProcesata && !row.detalii?.includes('ğŸ”'),
    'auto-split-parent': row.detalii?.includes('ğŸ”'),
    'tigari-row': row.categorie?.toLowerCase().includes('tigari') 
                  && !row.categorie?.toLowerCase().includes('bere'),
    'bere-row': row.categorie?.toLowerCase().includes('bere') 
                && !row.categorie?.toLowerCase().includes('tigari'),
    'mixed-row': row.categorie?.toLowerCase().includes('tigari') 
                 && row.categorie?.toLowerCase().includes('bere'),
    'special-row': row.detalii?.includes('|') || row.detalii?.includes('('),
    'incasare-row': row.tipTranzactie?.toLowerCase().includes('incasare')
  }">
</tr>






</table>
</div>
</div>

<!-- ğŸŒ€ Overlay OCR Loading -->
<div class="ocr-overlay" *ngIf="isLoadingOcr">
	<div class="ocr-loader">
		<div class="spinner">
		<p>Se proceseazÄƒ bonul OCR...</p>
		<mat-progress-bar
 mode="determinate"
		                  [value]="uploadProgress"
		                  color="accent"
		                  class="progress-bar"
/>
		<p>{{ uploadProgress }}%</p>
	</div>
</div>

<!-- ğŸ”¹ Form adÄƒugare categorie nouÄƒ -->
<div class="add-categorie-form">
	<mat-form-field appearance="outline" class="full-width">
		<mat-label>Categorie nouÄƒ</mat-label>
		<input
 type="text"
		       matInput
		       [formControl]="categorieControl"
		       [matAutocomplete]="autoCategorie"
		       placeholder="TasteazÄƒ pentru a filtra sau adÄƒuga"/>

		<mat-autocomplete #autoCategorie="matAutocomplete">
			<mat-option *ngFor="let cat of categoriiFiltrate | async" [value]="cat">
        {{ cat }}
			</mat-option>
			<mat-option
 *ngIf="categorieControl.value && !categorii.includes(categorieControl.value.trim().toUpperCase())"
			            [value]="categorieControl.value">
        â• AdaugÄƒ nouÄƒ:				<strong>{{ categorieControl.value }}</strong>
			</mat-option>
		</mat-autocomplete>
	</mat-form-field>

	<button mat-raised-button color="primary" (click)="adaugaCategorie()">â• AdaugÄƒ</button>
</div>




